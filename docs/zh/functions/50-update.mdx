---
weight: 50
sourceSHA: 6407d905a7fc120647950ef01fa97e9cf86151c6213e6587c090145b59faa597
---

# 更新规范

随着数据量的增长，资源分配的调整对于维护 Redis 的最佳性能至关重要。在达到存储或性能阈值之前，主动地扩展 Redis 实例，可以确保服务的持续可用性，并防止性能下降。

## 操作约束

1. **调度配置兼容性**：在扩展副本数量时，确保请求的数量符合为实例配置的任何现有节点调度约束（标签、污点、容忍度）。

2. **哨兵模式存储一致性**：在哨兵部署中，所有节点（主节点和副本）必须保持相同的存储容量分配，以确保正确的复制和故障切换能力。

3. **集群模式扩展灵活性**：在集群部署中，各个分片可以独立扩展，但在每个分片内，所有副本节点必须与其主节点保持存储容量的一致性。

4. **资源分配考虑事项**：在修改 CPU 和内存分配时：

   - 分析历史使用模式和预测增长
   - 在扩展之前核实集群资源的可用性
   - 考虑 Redis 内存开销需求（约比数据集大小多 30%）
   - 对于生产环境，实施渐进式扩展

   资源分配不足可能导致实例不稳定，而过量分配则会导致资源利用率低下。

## 操作步骤

<Tabs>
  <Tab label="CLI">
    实例规范通过 Redis 自定义资源中的 `spec.resources` 字段进行控制（详见 [API 文档](../../apis/kubernetes_apis/redis/redis) 获取详细参数信息）。

    ```bash
    # 更新实例资源到 300m CPU 和 300Mi 内存
    $ kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"resources":{"limits":{"cpu": "300m","memory":"300Mi"},"requests":{"cpu":"300m", "memory":"300Mi"}}}}'
    ```

    要监控扩展操作的进度：

    ```bash
    $ kubectl -n default get redis s6 -w
    ```
  </Tab>

  <Tab label="Web 控制台">
    1. 在左侧导航栏中导航到 **Redis**。

    2. 选择包含您实例的 ***命名空间名称***。

    3. 点击 ***实例名称*** 以访问其详细信息。

    4. 在 **详细信息** 选项卡中，找到拓扑图并在工具栏中点击 **更新规范**。

    5. 配置扩展参数：
       - 如有需要，调整副本数量（受架构约束）
       - 指定新的 CPU 和内存分配
       - 如有必要，修改存储容量

    6. 点击 **更新** 以启动扩展操作。
  </Tab>
</Tabs>

系统将逐步应用配置更改，以最小化服务中断。扩展操作成功完成后，拓扑视图将反映更新后的规范。

> **性能提示**：对于具有大数据集的实例，考虑在流量较低的时期执行扩展操作，以最小化对客户端操作的潜在影响。
