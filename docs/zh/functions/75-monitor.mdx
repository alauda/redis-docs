---
weight: 75
sourceSHA: d3a0e8e9834afec229459a865e6fd3c3394c1dc28f3e5e9bfcd0edbef7967602
---

# 监控与告警

内嵌面板中的监控数据可用于从资源、性能等方面进行 Redis 监控与告警，且支持配置通知策略。

## 监控

平台默认收集与 Redis 相关的资源和性能的常用监控指标。在实例的 **监控** 标签中，可以查看这些指标的实时监控数据。

| 类别                      | 指标                                      |
| ------------------------- | ------------------------------------------ |
| **集群状态监控**         | 键数目统计、命令统计等                    |
| **资源监控**             | 内存使用量、网络流量等                    |
| **性能监控**             | 连接数、网络 I/O 等                        |

## 告警

要为 Redis 创建告警规则，请进入 Alauda 应用服务的 **告警** > **规则** 页面。

### 配置告警规则

要启用告警，必须首先在应用服务中创建一个告警规则。告警规则描述了您希望监控的对象、在什么条件下希望收到告警，以及您将如何接收相关告警的通知。

平台内置了以下告警指标：

| 名称                                | 推荐触发条件                       | 说明                                                                                                                                                                    |
| :----------------------------------- | :---------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 实例状态                            | \!=1, 持续 30 秒                   | 监控集群的可用性                                                                                                                                                       |
| Key 访问命中率                      | \<80%, 持续 30 秒                  | 监控 Key 的命中率；低命中率表明访问的 Key 不存在，可能需要调整缓存策略、增加缓存 TTL 等。此外，TTL 表示缓存的有效期。                                           |
| 平均响应时间                        | >0.1s, 持续 30 秒                 | 响应时间过长可能导致处理能力下降；需检查是否存在 CPU 瓶颈、请求量过大或大量大键（Big Keys）问题。                                                                 |
| 主从切换                            | =1, 持续 30 秒                     | 主从切换可能表明 K8s 集群节点故障或 Redis 节点出现问题。                                                                                                               |
| 单节点输入带宽                      | 根据硬件条件判断                  | 实时监控带宽，防止带宽资源占用导致其他业务异常。                                                                                                                        |
| 单节点输出带宽                      | 根据硬件条件判断                  | 实时监控带宽，防止带宽资源占用导致其他业务异常。                                                                                                                        |
| 单节点客户端连接数                  | 根据资源条件判断                  | 用于监控异常连接情况。                                                                                                                                                 |
| 节点 CPU 使用率                     | >80%, 持续 30 秒                  | 实时监控 CPU 使用情况，若占用过高，需考虑扩展策略。                                                                                                                  |
| 节点内存使用率                      | >80%, 持续 30 秒                  | 实时监控内存使用情况，若占用过高需立即扩展。                                                                                                                           |
| 节点存储空间使用率                  | >80%, 持续 30 秒                  | 实时监控存储空间使用情况，若占用过高需考虑扩展。                                                                                                                      |

通过以上告警指标，可以快速创建告警规则。除了内置告警指标外，还可以自定义告警指标，格式如下：

```yaml
(1/(1+(avg(irate(redis_keyspace_misses_total{namespace=~"<namespace>", pod=~"<podname prefix>-.*"}[5m])) by(namespace,service) / (avg(irate(redis_keyspace_hits_total{namespace=~"<namespace>", pod=~"<podname prefix>-.*"}[5m])) by(namespace,service)+1))))
```

在此上下文中，`redis_keyspace_misses_total` 为 Prometheus 收集的指标名称，`<namespace>` 用于过滤资源所在的命名空间，`<podname prefix>` 是 Pods 的前缀，用于匹配由 `Deployment` 或 `StatefulSet` 创建的 Pods。有关编写指标的更多详细信息，请参阅 [PromQL 官方文档](https://prometheus.io/docs/prometheus/latest/querying/basics/)。

有关配置和使用告警的更多信息，请参见<ExternalSiteLink name="acp" href="appservice/unified-om/alert-policy-mgt/index" children="告警管理" />。
