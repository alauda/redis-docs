---
weight: 30
sourceSHA: 80a4bd2e39af179a256e8814e907b1d4f6d4af99b9d01f8d79acb38d999fc1f5
---

# 参数配置

创建 Redis 实例时，默认使用系统的参数模板。

Alauda 应用服务为每个版本的 Redis 提供了专门的参数模板（对于 6.0+ 版本提供三种模板，对于 5.0 版本提供两种），以满足不同的操作需求。

| 参数模板          | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 注意事项                                                                                                                                            |
| :---------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------- |
| RDB 参数模板      | **RDB 持久化参数模板** 配置了 Redis 以 RDB 持久化方式工作，在指定的时间间隔内将内存中的数据集以二进制快照的形式保存到磁盘。这种方式非常适合资源有限且需要在性能与数据耐久性之间取得平衡的环境，可以接受分钟级别的数据丢失。在这种模式下，Redis 可以充当持久化数据存储。                                                                                                         | 数据耐久性取决于 `save` 参数的配置，通常提供分钟级别的恢复点目标（RPO）。                                                                         |
| AOF 参数模板      | **AOF 持久化参数模板** 配置了 Redis 以追加只文件（AOF）方式工作，所有写操作按顺序记录到日志文件中，以确保数据的完整性。在实例恢复期间，Redis 会通过重放 AOF 文件中的操作来重建数据集。这种方式适合资源充足、对性能要求不高但对数据安全性有较高要求的环境。在这种模式下，Redis 也可以作为持久化数据存储使用。                                                                       | AOF 持久化所需的频繁 fsync 操作对存储基础设施要求较高，可能会影响 Redis 的整体性能，但可以提供秒级别的 RPO。                                  |
| 无盘参数模板      | **无盘参数模板** 完全禁用了 Redis 的持久化机制。在这种配置下，Redis 仅作为内存缓存以加速应用性能，所有数据都存储在内存中，没有磁盘持久化，导致 Redis 重启或发生故障时数据丢失。这种配置最大化了性能，但牺牲了数据耐久性。                                                                                                                             | 数据仅存在于内存中，消除了存储相关的性能开销。然而，如果所有 Redis 节点出现故障，则会导致数据完全丢失。                                     |

创建 Redis 实例时，请在 **创建 Redis 实例** 页面中的 **参数模板** 字段中选择最符合您业务需求的模板。

您还可以创建自定义参数模板以便在多个实例之间重用。

Redis 参数根据更改生效的方式分为三类：

| 名称                          | 参数                                                                                       | 说明                                                                                                                                 |
| :---------------------------- | :----------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| 热更新参数                   | 各种支持动态重新配置的参数                                                                | 更改后立即生效，无需重启实例。                                                                                                       |
| 重启更新参数                 | `databases`, `rename-command`, `rdbchecksum`, `tcp-backlog`, `io-threads`, `io-threads-do-reads` | 更改需要重启整个实例才能生效。                                                                                                       |
| 不可修改参数                 | `bind`, `protected-mode`, `port`, `supervised`, `pidfile`, `dir`, 等                    | 这些参数要么是内置的系统配置，要么在实例初始化后修改会导致操作不稳定，因此不应更改。                                                |

修改 Redis 参数时，请遵循以下最佳实践：

- 在实施参数更改之前，请先确定这些参数是否支持热更新。如果需要重启才能生效的参数，建议在修改前做好适当的数据备份。
- 升级 Redis 版本后，请查阅 [Redis 配置文档](https://redis.io/topics/config) 来审查参数兼容性，以识别过时、删除或修改的参数。

## 操作步骤

<Tabs>
  <Tab label="CLI">
    <br />

    ##### 数据节点参数

    实例的数据节点参数配置通过 Redis CR 资源的 `spec.customConfig` 字段指定。有关参数的详细说明，请参考 [API 文档](../apis/kubernetes_apis/redis/redis)。

    ```bash
    # 更新实例 s6 的数据节点配置
    $ kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"customConfig": {"save":"600 1"}}}'
    ```

    ##### 哨兵节点参数

    数据节点注册到哨兵节点的参数配置如下：

    > 目前仅支持以下三个参数：`down-after-milliseconds`, `failover-timeout`, `parallel-syncs`。

    ```bash
    # 更新实例 s6 的哨兵节点配置
    $ kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"sentinel": {"monitorConfig": {"down-after-milliseconds":"30000","failover-timeout":"180000","parallel-syncs":"1"}}}}'
    ```
  </Tab>

  <Tab label="Web Console">
    1. 在左侧导航栏中，单击 **Redis**。

    2. 单击 ***命名空间的名称***。

    3. 单击 ***实例名称***。

    4. 在 **参数配置** 页签中，单击 **更新实例参数** 或 **更新哨兵参数**。

    5. 设置参数。

    6. 单击 **更新**。
  </Tab>
</Tabs>
