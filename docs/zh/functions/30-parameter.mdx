---
weight: 30
sourceSHA: a9aea83a5b69dd8041ab1f766b2adc2d0fa9b984c7535513279b035f7c6fc3eb
---

# 参数配置

创建 Redis 实例时，默认使用系统参数模板。

灵雀云应用服务为每个版本的 Redis 提供了三种参数模板以适应不同的场景（5.0 仅有两种），方便用户快速创建实例。

| 参数模板          | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 注意事项                                                                                                                                            |
| :---------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------- |
| RDB 参数模板      | **RDB 持久化参数模板** 该参数模板配置了 Redis 以 RDB 持久化方式工作。RDB 持久化会在指定的时间间隔内将内存中的数据集以二进制格式保存到磁盘。适用于资源有限、需要在性能与数据可靠性之间取得平衡的场景，能够接受分钟级别的数据丢失。在这种模式下，Redis 可以作为存储数据库使用。                                                                                   | 数据可靠性基于配置的 `save` 参数提供，默认情况下提供分钟级别的可靠性。                                                                        |
| AOF 参数模板      | **AOF 持久化参数模板** 该参数模板配置了 Redis 以 AOF 持久化方式工作。AOF 持久化记录所有写操作到一个日志文件中（以追加方式），以确保数据安全。当 Redis 重启时，AOF 文件中的操作将被重放以重建数据集。适用于资源充足且对性能要求不高，但对数据安全性要求较高的场景。在这种模式下，Redis 也可以作为存储数据库使用。                                                        | 频繁的数据日志持久化对磁盘性能要求较高，可能会降低 Redis 整体性能，但可以提供秒级别的可靠性。                                                   |
| Diskless 参数模板 | **无盘参数模板** 该参数模板禁用了 Redis 的持久化功能。在此配置下，Redis 仅用作缓存层以加速应用访问，所有数据都存储在内存中。这意味着在 Redis 重新启动或失败时，所有数据将丢失。这种配置适用于对性能要求高，但对业务数据中断关注度低的场景。                                                                                                                  | 所有数据存储在内存中，因此性能不受存储影响。然而，如果所有节点失败，所有数据将会丢失。                                                        |

在创建实例时，您可以在 **创建 Redis 实例** 页面中选择最符合您业务需求的模板，字段为 **参数模板**。

您还可以在参数模板中创建自定义配置以便重用。

Redis 参数配置分为三类：

| 名称                          | 参数                                                                                       | 说明                                                                                                                                 |
| :---------------------------- | :----------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| 热更新参数                   |                                                                                           | 设置后立即生效，无需重启实例。                                                                                                       |
| 重启更新参数                 | `databases`, `rename-command`, `rdbchecksum`, `tcp-backlog`, `io-threads`, `io-threads-do-reads` | 更新后需要重启实例以生效。                                                                                                         |
| 不支持更新参数               | `bind`, `protected-mode`, `port`, `supervised`, `pidfile`, `dir`, 等                    | 部分参数是内置参数，或者在实例初始化后更新参数可能导致异常，因此不能更改。                                                          |

更新参数时，请注意以下细节：

- 在更新参数之前，请确保该参数是热更新参数。如果更新的参数中包括需要重启才能生效的参数，建议提前做好数据备份。
- 升级 Redis 版本后，如果有参数需要删除、废弃或变更，请查阅 [Redis 官方网站](https://redis.io/topics/config) 了解相应的修改。

## 操作步骤

<Tabs>
  <Tab label="CLI">
    <br />

    ##### 数据节点参数

    实例的数据节点参数配置通过 Redis CR 资源的 `spec.customConfig` 字段来指定。参数的具体说明可参考 [API 文档](../apis/kubernetes_apis/redis/redis)。

    ```bash
    # 更新 s6 实例的数据节点配置
    $ kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"customConfig": {"save":"600 1"}}}'
    ```

    ##### 哨兵节点参数

    数据节点注册到哨兵节点的参数如下配置：

    > 目前仅支持以下三个参数：`down-after-milliseconds`, `failover-timeout`, `parallel-syncs`。

    ```bash
    # 更新 s6 实例的哨兵节点配置
    $ kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"sentinel": {"monitorConfig": {"down-after-milliseconds":"30000","failover-timeout":"180000","parallel-syncs":"1"}}}}'
    ```
  </Tab>

  <Tab label="Web Console">
    1. 在左侧导航栏中，单击 **Redis**。

    2. 单击 ***命名空间的名称***。

    3. 单击 ***实例名称***。

    4. 在 **参数配置** 页签下，单击 **更新实例参数** 或 **更新哨兵参数**。

    5. 设置参数。

    6. 单击 **更新**。
  </Tab>
</Tabs>
