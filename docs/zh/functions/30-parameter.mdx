---
weight: 30
---

# 参数配置

创建 Redis 实例时默认使用系统参数模板。您也可在参数模板中自定义配置。

Redis 参数配置分为3类:

| 名称           | 参数     | 说明                                                                            |
|:---------------|:---------|:--------------------------------------------------------------------------------|
| 热更新参数     |          | 参数设置之后直接生效，不需要重启实例。                                          |
| 重启更新参数   | `databases`,`rename-command`,`rdbchecksum`,`tcp-backlog`,`io-threads`,`io-threads-do-reads` | 参数更新之后，需要重启实例才生效 |
| 不支持更新参数 | `bind`,`protected-mode`,`port`,`supervised`,`pidfile`,`dir` 等 | 部分参数是内置参数，或者在实例初始化之后，更新参数会引起实例异常，从而不可更改。|


更新参数需要注意以下内容:

* 更新参数前，请确认参数是否是热更新参数，如果更新参数中包含需要重启更新的参数，建议体检做好数据备份。
* Redis 版本升级后，如果有需要删除、废弃或变更的参数配置，请查阅 [Redis 官网](https://redis.io/topics/config) 对应修改。

## 操作步骤

<Tabs>

<Tab label="CLI">

<br/>
##### 数据节点参数

实例的数据节点参数参数配置通过 Redis CR 资源的 `spec.customConfig` 字段来指定。参数的具体说明可参考 [API 文档](../apis/kubernetes_apis/redis/redis)。

```bash
# 更新 s6 实例的数据节点配置
kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"customConfig": {"save":"600 1"}}}'
```

##### 哨兵节点参数

数据节点注册到哨兵节点的参数如下配置:

> 目前只支持 `down-after-milliseconds`,`failover-timeout`,`parallel-syncs` 这3个参数。

```bash
# 更新 s6 实例的哨兵节点配置
kubectl -n default patch redis s6 --type=merge --patch='{"spec": {"sentinel": {"monitorConfig": {"down-after-milliseconds":"30000","failover-timeout":"180000","parallel-syncs":"1"}}}}'
```

</Tab>


<Tab label="Web Console">

1. 在左侧导航栏中，单击 **Redis**。

2. 单击 ***命名空间的名称***。

2. 单击 ***实例名称*** 。

3. 在 **参数配置** 页签下，单击 **更新实例参数** 或 **更新哨兵参数**。

4. 设置参数。

5. 单击 **更新**。

</Tab>

</Tabs>

平台针对不同场景，对 Redis 各版本分别提供了3个参数模板(5.0 只有两个)，方便用户快速创建实例。

| 参数模板          | 说明                                              | 注意事项      |
|:------------------|:--------------------------------------------------|:--------------|
| RDB 参数模板      | **RDB 持久化参数模板** 该参数模板配置了 Redis 以 RDB 持久化方式工作。RDB 持久化会在指定的时间间隔内，将内存中的数据集以二进制形式保存到磁盘。适用于资源有限，同时兼顾性能、数据可靠性，可接受分钟以内的数据丢失的业务场景。在此模式下，Redis 可作为存储数据库使用。 | 根据设置的`save`参数来提供数据可靠性，默认提供分钟级别的数据可靠性。|
| AOF 参数模板      | **AOF 持久化参数模板** 该参数模板配置了 Redis 以 AOF 持久化方式工作。AOF 持久化会将所有写操作记录到一个日志文件中（以追加的方式），以确保数据安全。当 Redis 重启时，AOF 文件中的操作会被重新执行以重建数据集。适用于资源充足，对性能要求不高，但对数据安全要求足够高的业务场景。在此模式下，Redis 可作为存储数据库使用。| 频繁的数据日志持久化，对磁盘要求较高，会降低 Redis 的整体性能，但是可以提供秒级别的可靠性。|
| Diskless 参数模板 | **无盘参数模板** 该参数模板关闭了 Redis 的持久化功能。在这种配置下，Redis 仅作为缓存层来加速应用访问，所有数据都存储在内存中。这意味着在 Redis 重启或发生故障时，所有数据都将丢失。这种配置适用于对性能要求高，但对业务数据中断关注度不高的业务场景。| 数据都存储在内存，性能不受存储的影响。但是在所有节点出现宕机时，所有数据都会丢失。|
