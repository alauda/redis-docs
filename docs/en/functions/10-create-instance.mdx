---
weight: 10
sourceSHA: f9bfcbdca6540fe5c33b1d774fbf710c3808a2b3c37f3beb9c252bd5845b999e
---

# Create Instance

Following Redis versions are fully supported: `5.0`, `6.0`, `7.2`; other versions are not supported by default.

<Directive type="tip" title="Version suggestion">
  When used in a production environment, it is recommended to prioritize the `7.2` version, followed by `6.0`.

  1. `7.2` is a version still maintained by the community, which fixes known issues in `6.0` and `5.0`. The `6.0` and `5.0` versions are no longer maintained by the community.
  2. `7.2` is fully compatible with `6.0` and `5.0`.
  3. `7.2` has further improved the ACL features.
  4. `5.0` is not recommended for use as it does not support advanced features like ACL and lacks user management capabilities; all business processes will share a single password, presenting potential security risks; also, changing the password requires restarting all nodes.
</Directive>

<Directive type="note" title="Architecture suggestion">
  `Single-node architecture` has no replica nodes and lacks failover capabilities, so it should only be used in development and testing environments. You can choose between `Sentinel architecture` and `Cluster architecture` based on your business's data and concurrency needs.
</Directive>

## Create Redis Instance

### Procedure

<Tabs>
  <Tab label="Sentinel CLI">
    Create a Redis 6.0 Sentinel mode instance using CLI:

    ```bash
    $ cat << EOF | kubectl -n default create -f -
    apiVersion: middleware.alauda.io/v1
    kind: Redis
    metadata:
      name: s6
    spec:
      arch: sentinel
      customConfig:
        databases: "16"
        hz: "10"
        save: 60 10000 300 100 600 1
        timeout: "0"
      exporter:
        enabled: true
        resources:
          limits:
            cpu: 100m
            memory: 384Mi
          requests:
            cpu: 50m
            memory: 128Mi
      replicas:
        sentinel:
          master: 1
          slave: 1
      resources:
        limits:
          cpu: "1"
          memory: 2Gi
        requests:
          cpu: "1"
          memory: 2Gi
      sentinel:
        monitorConfig:
          down-after-milliseconds: "30000"
          failover-timeout: "180000"
          parallel-syncs: "1"
        replicas: 3
        resources:
          limits:
            cpu: 100m
            memory: 128Mi
          requests:
            cpu: 100m
            memory: 128Mi
      version: "6.0"
    EOF
    ```

    Refer to the [Redis API documentation](../apis/kubernetes_apis/redis/redis.mdx) for field descriptions.

  </Tab>

  <Tab label="Cluster CLI">
    Create a Redis 6.0 Cluster mode instance using CLI:

    ```bash
    $ cat << EOF | kubectl -n default create -f -
    apiVersion: middleware.alauda.io/v1
    kind: Redis
    metadata:
      name: c6
    spec:
      affinityPolicy: AntiAffinityInSharding
      arch: cluster
      customConfig:
        hz: "10"
        save: 60 10000 300 100 600 1
        timeout: "0"
      exporter:
        enabled: true
        resources:
          limits:
            cpu: 100m
            memory: 384Mi
          requests:
            cpu: 50m
            memory: 128Mi
      expose:
        type: NodePort
      replicas:
        cluster:
          shard: 3
          slave: 1
      resources:
        limits:
          cpu: 200m
          memory: 200Mi
        requests:
          cpu: 200m
          memory: 200Mi
      version: "6.0"
    EOF
    ```

    Refer to the [Redis API documentation](../apis/kubernetes_apis/redis/redis.mdx) for field descriptions.
  </Tab>

  <Tab label="Standalone CLI">
    Create a Redis 6.0 Standalone mode instance using CLI:

    ```bash
    $ cat << EOF | kubectl -n default create -f -
    apiVersion: middleware.alauda.io/v1
    kind: Redis
    metadata:
      name: standalone
    spec:
      arch: standalone
      customConfig:
        databases: "16"
        hz: "10"
        save: 60 10000 300 100 600 1
        timeout: "0"
      exporter:
        enabled: true
        resources:
          limits:
            cpu: 100m
            memory: 384Mi
          requests:
            cpu: 50m
            memory: 128Mi
      replicas:
        sentinel:
          master: 1
      resources:
        limits:
          cpu: "1"
          memory: 1Gi
        requests:
          cpu: "1"
          memory: 1Gi
      version: "6.0"
    EOF
    ```

    Refer to the [Redis API documentation](../apis/kubernetes_apis/redis/redis.mdx) for field descriptions.
  </Tab>

  <Tab label="Web Console">
    1. Enter Alauda Application Services view.

    1. In the left navigation bar of Alauda Application Services view, click **Redis**.

    1. Click ***Namespace name***.

    1. Click **Create Redis Instance**.

    1. Select an architecture type.

    1. Refer to the instructions below to complete the relevant configurations.

           <table border="">
             <tr>
               <th style={{width: '100px'}}>Configuration</th>
               <th style={{width: '130px'}}>Configuration Item</th>
               <th>Description</th>
             </tr>

             <tr>
               <td><b>Parameter Configuration</b></td>
               <td><b>Parameter Template</b></td>
               <td>You can choose between system or custom parameter templates. For custom parameter templates please refer to <ExternalSiteLink name="acp" href="/appservice/unified-om/para-template-mgt/index" children="Parameter Template Management" />.</td>
             </tr>

             <tr>
               <td rowspan="3"><b>Connection Configuration</b></td>
               <td><b>Set Default Password</b></td>
               <td>It is recommended to set a password for redis `default` user when startup instance. If no password is set, refer to <a href="../functions/20-user">User Management</a> to reset the password or create extra accounts.</td>
             </tr>

             <tr>
               <td><b>Access Method</b></td>
               <td>If applications and Redis instances resize in different workload clusters, use <b>external access</b> method. <b>External access</b> method supports `LoadBalancer` and `NodePort` where `LoadBalancer` is recommended for production environments. If applications and Redis instances resize in the same workload cluster, use <b>Within the Cluster</b> access method.</td>
             </tr>

             <tr>
               <td><b>Specify Host Port</b></td>
               <td>When using NodePort for external access, you can specify the service nodeport numbers. <br /><b>Sentinel Mode</b>: When updating the instance, ports cannot be swapped; if you need to swap ports, update to another unoccupied port first, then re-specify. <br /><b>Cluster Mode</b>: When updating the instance, if you only need to replace one port, you can re-enter or modify the corresponding node port in YAML.</td>
             </tr>

             <tr>
               <td rowspan="3"><b>Scheduling Configuration</b></td>
               <td><b>Anti-Affinity Policy</b></td>
               <td>To meet the demands for high reliability and high availability under different business scenarios, the platform provides an anti-affinity policy for <b>Cluster Mode</b>, where <b>Force anti-affinity</b> is the default applied anti-affinity policy. <br /><b>Note</b>: Once the instance is created, this configuration can no longer be modified.</td>
             </tr>

             <tr>
               <td><b>Node Labels</b></td>
               <td>Filter available nodes in the current cluster through labels. Pods will be scheduled to available nodes. <br /><b>Note</b>: Once the instance is created, this configuration can no longer be modified.</td>
             </tr>

             <tr>
               <td><b>Pod Toleration</b></td>
               <td> If available nodes have taints, only Pods with tolerations set will tolerate these taints and may be scheduled to nodes that match the Pod toleration and node taint. The matching rules are as follows. <ul><li><b>Equal</b>: When the <i>key</i>, <i>value</i>, and <i>effect</i> that the Pod tolerates match exactly with the node taint settings, the Pod will tolerate the node taint. </li><li><b>Exists</b>: When the <i>key</i> and <i>effect</i> that the Pod tolerates remain consistent with the node taint settings, the Pod will tolerate the node taint. </li></ul> <br /><b>Note</b>: The effect determines whether Pods that do not tolerate the node taint will be assigned to the node with the taint. For example, if the effect is NoExecute, only Pods that tolerate the taint (including Pods in this Redis instance) will be scheduled, and already running Pods on the node that do not tolerate the taint will be evicted (Pods from other instances). For more information on matching rules, please refer to the <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">Kubernetes community documentation</a>.</td>
             </tr>
           </table>

       > The current Web Console does not support creating `standalone` (Redis single-node architecture).

    1. Click **Create**.

       Once the instance status changes to **Running**, the instance has been successfully created.
  </Tab>
</Tabs>

After the instance is created, you can use the following command to check the status of the instance:

```bash
$ kubectl -n default get redis
NAME         ARCH         VERSION   ACCESS     STATUS         MESSAGE   BUNDLE VERSION   AUTOUPGRADE   AGE
c5           cluster      5.0       NodePort   Ready                    4.0.1                         2m46s
c6           cluster      6.0                  Initializing             4.0.1                         3m26s
c7           cluster      7.2       NodePort   Initializing             4.0.1                         98s
s5           sentinel     5.0                  Ready                    4.0.1                         3m10s
s6           sentinel     6.0                  Ready                    4.0.1                         25m
s7           sentinel     7.2       NodePort   Ready                    4.0.1                         2m15s
standalone   standalone   6.0                  Initializing             4.0.1                         6s
```

The meanings of the output table fields are as follows:

| Field           | Description                                                                                                                                                                                 |
| :------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NAME           | Instance name                                                                                                                                                                               |
| ARCH           | This value corresponds to the architecture of Redis. <ul><li>`cluster`: Cluster mode</li><li> `sentinel`: Sentinel mode </li><li>`standalone`: Single-node Redis</li></ul>  This field indicates whether this CR resource manages a standalone, Sentinel, or Cluster mode of Redis. |
| VERSION        | Currently supports only the 3 versions: `5.0`, `6.0`, `7.2`                                                                                                                                       |
| ACCESS         | The access methods supported by the instance. <ul><li>` `: The instance provides services via ClusterIP</li><li>`NodePort`: The instance provides services via NodePort</li><li>`LoadBalancer`: The instance provides services via LoadBalancer</li></ul> |
| STATUS         | The current status of the instance, which may include the following states: <ul><li>`Initializing`: The instance is initializing or updating</li><li>`Rebalancing`: The cluster instance is scaling up or down</li><li>`Error`: The instance has encountered a non-recoverable error</li><li>`Paused`: The instance has been manually paused</li><li>`Ready`: The instance is ready</li></ul> |
| MESSAGE        | The reason for the instance being in its current status                                                                                                                                           |
| BUNDLE VERSION | The version number of the operator managing the instance                                                                                                                                         |
| AUTOUPGRADE    | Whether automatic upgrades are enabled for the instance                                                                                                                                         |
| AGE            | How long ago the instance was created                                                                                                                                                        |
